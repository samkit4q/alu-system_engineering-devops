#!/usr/bin/env bash

# Bash script to install and configure Nginx web server
# It installs Nginx, configures it to listen on port 80,
# and ensures it serves a page containing "Holberton School" at its root.

# Update package list and install Nginx
apt-get update -y
apt-get install nginx -y

# Configure Nginx to listen on port 80
sed -i 's/^\(.*listen\s*\)80/\180/' /etc/nginx/sites-available/default

# Restart Nginx
service nginx restart

# Check if Nginx is running
if systemctl is-active --quiet nginx; then
    echo "Nginx is running."
else
    echo "Failed to start Nginx."
    exit 1
fi

# Create a temporary HTML file
echo "Holberton School for the win!" > /var/www/html/index.html

# Test if Nginx serves the correct page
if curl -s localhost | grep -q "Holberton School"; then
    echo "Nginx is serving the correct page."
else
    echo "Nginx is not serving the correct page."
    exit 1
fi
